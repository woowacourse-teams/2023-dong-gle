"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[251],{"./node_modules/@tanstack/react-query/build/lib/useMutation.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{D:()=>useMutation});var react=__webpack_require__("./node_modules/react/index.js"),utils=__webpack_require__("./node_modules/@tanstack/query-core/build/lib/utils.mjs"),mutation=__webpack_require__("./node_modules/@tanstack/query-core/build/lib/mutation.mjs"),notifyManager=__webpack_require__("./node_modules/@tanstack/query-core/build/lib/notifyManager.mjs"),subscribable=__webpack_require__("./node_modules/@tanstack/query-core/build/lib/subscribable.mjs");class MutationObserver extends subscribable.l{constructor(client,options){super(),this.client=client,this.setOptions(options),this.bindMethods(),this.updateResult()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(options){var _this$currentMutation;const prevOptions=this.options;this.options=this.client.defaultMutationOptions(options),(0,utils.VS)(prevOptions,this.options)||this.client.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.currentMutation,observer:this}),null==(_this$currentMutation=this.currentMutation)||_this$currentMutation.setOptions(this.options)}onUnsubscribe(){var _this$currentMutation2;this.hasListeners()||(null==(_this$currentMutation2=this.currentMutation)||_this$currentMutation2.removeObserver(this))}onMutationUpdate(action){this.updateResult();const notifyOptions={listeners:!0};"success"===action.type?notifyOptions.onSuccess=!0:"error"===action.type&&(notifyOptions.onError=!0),this.notify(notifyOptions)}getCurrentResult(){return this.currentResult}reset(){this.currentMutation=void 0,this.updateResult(),this.notify({listeners:!0})}mutate(variables,options){return this.mutateOptions=options,this.currentMutation&&this.currentMutation.removeObserver(this),this.currentMutation=this.client.getMutationCache().build(this.client,{...this.options,variables:void 0!==variables?variables:this.options.variables}),this.currentMutation.addObserver(this),this.currentMutation.execute()}updateResult(){const state=this.currentMutation?this.currentMutation.state:(0,mutation.R)(),result={...state,isLoading:"loading"===state.status,isSuccess:"success"===state.status,isError:"error"===state.status,isIdle:"idle"===state.status,mutate:this.mutate,reset:this.reset};this.currentResult=result}notify(options){notifyManager.V.batch((()=>{var _this$mutateOptions$o,_this$mutateOptions,_this$mutateOptions$o2,_this$mutateOptions2;if(this.mutateOptions&&this.hasListeners())if(options.onSuccess)null==(_this$mutateOptions$o=(_this$mutateOptions=this.mutateOptions).onSuccess)||_this$mutateOptions$o.call(_this$mutateOptions,this.currentResult.data,this.currentResult.variables,this.currentResult.context),null==(_this$mutateOptions$o2=(_this$mutateOptions2=this.mutateOptions).onSettled)||_this$mutateOptions$o2.call(_this$mutateOptions2,this.currentResult.data,null,this.currentResult.variables,this.currentResult.context);else if(options.onError){var _this$mutateOptions$o3,_this$mutateOptions3,_this$mutateOptions$o4,_this$mutateOptions4;null==(_this$mutateOptions$o3=(_this$mutateOptions3=this.mutateOptions).onError)||_this$mutateOptions$o3.call(_this$mutateOptions3,this.currentResult.error,this.currentResult.variables,this.currentResult.context),null==(_this$mutateOptions$o4=(_this$mutateOptions4=this.mutateOptions).onSettled)||_this$mutateOptions$o4.call(_this$mutateOptions4,void 0,this.currentResult.error,this.currentResult.variables,this.currentResult.context)}options.listeners&&this.listeners.forEach((({listener})=>{listener(this.currentResult)}))}))}}var useSyncExternalStore=__webpack_require__("./node_modules/@tanstack/react-query/build/lib/useSyncExternalStore.mjs"),QueryClientProvider=__webpack_require__("./node_modules/@tanstack/react-query/build/lib/QueryClientProvider.mjs"),lib_utils=__webpack_require__("./node_modules/@tanstack/react-query/build/lib/utils.mjs");function useMutation(arg1,arg2,arg3){const options=(0,utils.lV)(arg1,arg2,arg3),queryClient=(0,QueryClientProvider.NL)({context:options.context}),[observer]=react.useState((()=>new MutationObserver(queryClient,options)));react.useEffect((()=>{observer.setOptions(options)}),[observer,options]);const result=(0,useSyncExternalStore.$)(react.useCallback((onStoreChange=>observer.subscribe(notifyManager.V.batchCalls(onStoreChange))),[observer]),(()=>observer.getCurrentResult()),(()=>observer.getCurrentResult())),mutate=react.useCallback(((variables,mutateOptions)=>{observer.mutate(variables,mutateOptions).catch(noop)}),[observer]);if(result.error&&(0,lib_utils.L)(observer.options.useErrorBoundary,[result.error]))throw result.error;return{...result,mutate,mutateAsync:result.mutate}}function noop(){}},"./src/components/Category/WritingList/WritingList.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Playground:()=>Playground,__namedExportsOrder:()=>__namedExportsOrder,default:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__={title:"writing/WritingList",component:__webpack_require__("./src/components/Category/WritingList/WritingList.tsx").Z,args:{categoryId:1,isOpen:!0},argTypes:{categoryId:{description:"현재 속한 카테고리의 아이디입니다."},isOpen:{description:"카테고리 토글의 열림 여부 입니다."}}},Playground={};Playground.parameters={...Playground.parameters,docs:{...Playground.parameters?.docs,source:{originalSource:"{}",...Playground.parameters?.docs?.source}}};const __namedExportsOrder=["Playground"]},"./src/apis/category.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{CP:()=>getCategories,K8:()=>updateCategoryOrder,KD:()=>getWritingsInCategory,i8:()=>addCategory,kQ:()=>updateCategoryTitle,uu:()=>deleteCategory});var constants_apis_url__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/constants/apis/url.ts"),_fetch__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/apis/fetch.ts");const addCategory=body=>_fetch__WEBPACK_IMPORTED_MODULE_1__.d.post(constants_apis_url__WEBPACK_IMPORTED_MODULE_0__.jA,{json:body}),getCategories=()=>_fetch__WEBPACK_IMPORTED_MODULE_1__.d.get(constants_apis_url__WEBPACK_IMPORTED_MODULE_0__.jA).json(),getWritingsInCategory=categoryId=>_fetch__WEBPACK_IMPORTED_MODULE_1__.d.get(`${constants_apis_url__WEBPACK_IMPORTED_MODULE_0__.jA}/${categoryId}`).json(),updateCategoryTitle=({categoryId,body})=>_fetch__WEBPACK_IMPORTED_MODULE_1__.d.patch(`${constants_apis_url__WEBPACK_IMPORTED_MODULE_0__.jA}/${categoryId}`,{json:body}),updateCategoryOrder=({categoryId,body})=>_fetch__WEBPACK_IMPORTED_MODULE_1__.d.patch(`${constants_apis_url__WEBPACK_IMPORTED_MODULE_0__.jA}/${categoryId}`,{json:body}),deleteCategory=categoryId=>_fetch__WEBPACK_IMPORTED_MODULE_1__.d.delete(`${constants_apis_url__WEBPACK_IMPORTED_MODULE_0__.jA}/${categoryId}`)},"./src/apis/fetch.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{d:()=>fetch_http});var distribution=__webpack_require__("./node_modules/ky/distribution/index.js"),HttpError=__webpack_require__("./src/utils/apis/HttpError.ts"),url=__webpack_require__("./src/constants/apis/url.ts");const fetch_http=distribution.ZP.create({hooks:{beforeError:[error=>{const{response,request,options}=error;return(0,HttpError.S)(response,request,options)}],beforeRequest:[request=>{request.headers.set("Authorization",`Bearer ${localStorage.getItem("accessToken")??""}`)}],afterResponse:[async(request,options,response)=>{if(401===response.status){const{error}=await response.json();if(4011===error.code){const newAccessToken=(await fetch_http.post(`${url.qW}/token/refresh`).json()).accessToken;return localStorage.setItem("accessToken",newAccessToken),request.headers.set("Authorization",`Bearer ${newAccessToken}`),fetch_http(request)}}}]}})},"./src/components/Category/WritingList/WritingList.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>WritingList_WritingList});var icons=__webpack_require__("./src/assets/icons/index.ts"),usePageNavigate=__webpack_require__("./src/hooks/usePageNavigate.ts"),styled_components_browser_esm=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js"),category=__webpack_require__("./src/apis/category.ts"),useQuery=__webpack_require__("./node_modules/@tanstack/react-query/build/lib/useQuery.mjs");var DeleteButton=__webpack_require__("./src/components/DeleteButton/DeleteButton.tsx"),QueryClientProvider=__webpack_require__("./node_modules/@tanstack/react-query/build/lib/QueryClientProvider.mjs"),useMutation=__webpack_require__("./node_modules/@tanstack/react-query/build/lib/useMutation.mjs"),url=__webpack_require__("./src/constants/apis/url.ts"),fetch=__webpack_require__("./src/apis/fetch.ts");const moveToTrash=writingIds=>{const json={writingIds,isPermanentDelete:!1};return fetch.d.post(url.zP,{json})};var useToast=__webpack_require__("./src/hooks/@common/useToast.ts"),HttpError=__webpack_require__("./src/utils/apis/HttpError.ts");var dist=__webpack_require__("./node_modules/@yogjin/react-global-state/dist/index.js"),globalState=__webpack_require__("./src/globalState/index.ts"),drag=__webpack_require__("./src/constants/drag.ts"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const WritingList=({categoryId,isOpen,dragOverIndexList,onDragStart,onDragEnter,onDragEnd,isWritingDragging})=>{const{goWritingPage}=(0,usePageNavigate.L)(),{writings}=((categoryId,isOpen)=>{const{data}=(0,useQuery.a)(["writingsInCategory",categoryId],(()=>(0,category.KD)(categoryId)),{enabled:Boolean(isOpen)});return{writings:data?data.writings:null}})(categoryId,isOpen),activeWritingInfo=(0,dist.aO)(globalState.Jc),writingId=activeWritingInfo?.id,deleteWritings=(()=>{const queryClient=(0,QueryClientProvider.NL)(),{goTrashCanPage}=(0,usePageNavigate.L)(),toast=(0,useToast.p)(),{mutate}=(0,useMutation.D)(moveToTrash,{onSuccess:()=>{toast.show({type:"success",message:"글이 휴지통으로 이동됐습니다."}),queryClient.invalidateQueries(["deletedWritings"]),queryClient.invalidateQueries(["writingsInCategory"]),goTrashCanPage()},onError:error=>{error instanceof HttpError.o&&toast.show({type:"error",message:error.message})}});return writingIds=>{confirm("글을 삭제하시겠습니까?")&&mutate(writingIds)}})(),isWritingDragOverTarget=(categoryId,writingId)=>isWritingDragging&&categoryId===dragOverIndexList[drag.k.CATEGORY_ID]&&writingId===dragOverIndexList[drag.k.WRITING_ID];return writings&&0!==writings?.length?(0,jsx_runtime.jsxs)("ul",{children:[writings.map((writing=>(0,jsx_runtime.jsxs)(S.Item,{$isClicked:writingId===writing.id,$isDragOverTarget:isWritingDragOverTarget(categoryId,writing.id),draggable:!0,onDragStart:onDragStart(categoryId,writing.id),onDragEnter:onDragEnter(categoryId,writing.id),onDragEnd,children:[(0,jsx_runtime.jsxs)(S.Button,{"aria-label":`${writing.title}글 메인화면에 열기`,onClick:()=>goWritingPage({categoryId,writingId:writing.id,isDeletedWriting:!1}),children:[(0,jsx_runtime.jsx)(S.IconWrapper,{children:(0,jsx_runtime.jsx)(icons.C,{width:14,height:14})}),(0,jsx_runtime.jsx)(S.Text,{children:writing.title})]}),(0,jsx_runtime.jsx)(S.DeleteButtonWrapper,{children:(0,jsx_runtime.jsx)(DeleteButton.Z,{onClick:()=>deleteWritings([writing.id]),"aria-label":`${writing.title}글 삭제`})})]},writing.id))),(0,jsx_runtime.jsx)(S.DragLastSection,{onDragEnter:onDragEnter(categoryId,drag.j),$isDragOverTarget:isWritingDragOverTarget(categoryId,drag.j)})]}):(0,jsx_runtime.jsx)(S.NoWritingsText,{children:"빈 카테고리"})};WritingList.displayName="WritingList";const WritingList_WritingList=WritingList,S={Item:styled_components_browser_esm.zo.li`
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
    height: 3.6rem;
    border-radius: 4px;
    background-color: ${({theme,$isClicked})=>$isClicked&&theme.color.gray4};
    border-top: 0.4rem solid transparent;

    ${({$isDragOverTarget})=>$isDragOverTarget&&styled_components_browser_esm.iv`
        border-radius: 0;
        border-top: 0.4rem solid ${({theme})=>theme.color.dragArea};
      `};
    &:hover {
      background-color: ${({theme})=>theme.color.gray3};

      & > button {
        padding-right: 2.8rem;
      }

      div {
        opacity: 0.99;
      }
    }
  `,Button:styled_components_browser_esm.zo.button`
    display: flex;
    align-items: center;
    gap: 0.4rem;
    width: 100%;
    min-width: 0;
    height: 100%;
    padding: 0.4rem 0 0.4rem 3.2rem;
    border-radius: 4px;
  `,IconWrapper:styled_components_browser_esm.zo.div`
    flex-shrink: 0;
  `,Text:styled_components_browser_esm.zo.p`
    color: ${({theme})=>theme.color.gray9};
    font-size: 1.4rem;
    font-weight: 400;
    overflow: hidden;
    white-space: nowrap;
    text-overflow: ellipsis;
  `,NoWritingsText:styled_components_browser_esm.zo.p`
    padding: 0.4rem 0 0.4rem 3.2rem;
    color: ${({theme})=>theme.color.gray6};
    font-size: 1.4rem;
    font-weight: 500;
    cursor: default;
  `,DeleteButtonWrapper:styled_components_browser_esm.zo.div`
    position: absolute;
    right: 0;
    margin-right: 0.8rem;
    opacity: 0;
  `,DragLastSection:styled_components_browser_esm.zo.div`
    height: 0.4rem;
    background-color: transparent;
    ${({$isDragOverTarget})=>$isDragOverTarget&&styled_components_browser_esm.iv`
        background-color: ${({theme})=>theme.color.dragArea};
      `};
  `};try{WritingList.displayName="WritingList",WritingList.__docgenInfo={description:"",displayName:"WritingList",props:{categoryId:{defaultValue:null,description:"",name:"categoryId",required:!0,type:{name:"number"}},isOpen:{defaultValue:null,description:"",name:"isOpen",required:!0,type:{name:"boolean"}},dragOverIndexList:{defaultValue:null,description:"",name:"dragOverIndexList",required:!0,type:{name:"number[]"}},onDragStart:{defaultValue:null,description:"",name:"onDragStart",required:!0,type:{name:"(...ids: number[]) => (e: DragEvent<Element>) => void"}},onDragEnter:{defaultValue:null,description:"",name:"onDragEnter",required:!0,type:{name:"(...ids: number[]) => (e: DragEvent<Element>) => void"}},onDragEnd:{defaultValue:null,description:"",name:"onDragEnd",required:!0,type:{name:"(e: DragEvent<Element>) => void"}},isWritingDragging:{defaultValue:null,description:"",name:"isWritingDragging",required:!0,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/Category/WritingList/WritingList.tsx#WritingList"]={docgenInfo:WritingList.__docgenInfo,name:"WritingList",path:"src/components/Category/WritingList/WritingList.tsx#WritingList"})}catch(__react_docgen_typescript_loader_error){}},"./src/components/DeleteButton/DeleteButton.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});var assets_icons__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/assets/icons/index.ts"),styled_components__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/styled-components/dist/styled-components.browser.esm.js"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/jsx-runtime.js");const DeleteButton=({...rest})=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(S.Button,{...rest,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_1__.jsx)(assets_icons__WEBPACK_IMPORTED_MODULE_0__.Ms,{width:12,height:12,"aria-label":"휴지통 아이콘"})});DeleteButton.displayName="DeleteButton";const __WEBPACK_DEFAULT_EXPORT__=DeleteButton,S={Button:styled_components__WEBPACK_IMPORTED_MODULE_2__.zo.button`
    display: flex;
    justify-content: center;
    align-items: center;
    width: 2rem;
    height: 2.4rem;
    border-radius: 4px;

    &:hover {
      background-color: ${({theme})=>theme.color.gray5};
    }
  `};try{DeleteButton.displayName="DeleteButton",DeleteButton.__docgenInfo={description:"",displayName:"DeleteButton",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/DeleteButton/DeleteButton.tsx#DeleteButton"]={docgenInfo:DeleteButton.__docgenInfo,name:"DeleteButton",path:"src/components/DeleteButton/DeleteButton.tsx#DeleteButton"})}catch(__react_docgen_typescript_loader_error){}},"./src/constants/drag.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{j:()=>LAST_DRAG_SECTION_ID,k:()=>INDEX_POSITION});const LAST_DRAG_SECTION_ID=-1,INDEX_POSITION={CATEGORY_ID:0,WRITING_ID:1}}}]);
//# sourceMappingURL=components-Category-WritingList-WritingList-stories.e70878b0.iframe.bundle.js.map